<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trắc nghiệm nhiều bài</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        .container {
            max-width: 600px;
            margin: auto;
        }

        .question {
            font-size: 18px;
            margin-bottom: 10px;
            text-align: left;
        }

        .options label {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }

        button {
            margin-top: 10px;
            padding: 10px;
            cursor: pointer;
        }

        .correct {
            color: green;
            font-weight: bold;
        }

        .incorrect {
            color: red;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2>Trắc nghiệm nhiều bài</h2>
        <!-- Chọn bài quiz -->
        <div>
            <label for="quizSelector">Chọn bài:</label>
            <select id="quizSelector">
                <option value="1">Bài 1 - Đá bóng</option>
                <option value="2">Bài 2 - Game</option>
                <option value="3">Bài 3 - Chủ đề khác</option>
                <!-- Thêm các bài khác nếu cần -->
            </select>
            <button onclick="loadQuiz()">Lấy câu hỏi</button>
        </div>
        <!-- Khu vực hiển thị câu hỏi -->
        <div id="quiz"></div>
        <!-- Nút nộp bài & làm lại -->
        <button onclick="submitQuiz()">Nộp bài</button>
        <button onclick="resetQuiz()">Làm lại</button>
        <!-- Hiển thị kết quả -->
        <h3 id="result"></h3>
    </div>

    <script>
        let questions = [];

        // Hàm lấy quiz theo quizId từ dropdown và gọi API backend
        async function loadQuiz() {
            const quizId = document.getElementById('quizSelector').value;
            try {
                // Thay 'https://your-backend-url.onrender.com' bằng URL backend đã deploy (có endpoint /questions)
                const response = await fetch(`https://quizapp-1-vwbx.onrender.com/questions?quizId=${quizId}`);
                questions = await response.json();
                renderQuestions();
            } catch (error) {
                console.error('Lỗi lấy dữ liệu:', error);
            }
        }

        // Hàm hiển thị câu hỏi lên giao diện
        function renderQuestions() {
            const quizDiv = document.getElementById('quiz');
            quizDiv.innerHTML = '';
            questions.forEach((q, index) => {
                let optionsHtml = q.options.map((option, i) =>
                    `<label><input type="radio" name="question${index}" value="${i}"> ${option}</label>`
                ).join('');
                quizDiv.innerHTML += `
          <div class="question">
            <p><strong>Câu ${index + 1}:</strong> ${q.question}</p>
            <div class="options">${optionsHtml}</div>
            <p id="answer${index}" class="correct" style="display: none;">Đáp án đúng: ${q.options[q.answer]}</p>
          </div>
        `;
            });
        }

        // Hàm nộp bài và tính điểm
        function submitQuiz() {
            if (questions.length === 0) {
                alert('Chưa có câu hỏi!');
                return;
            }
            let score = 0;
            questions.forEach((q, index) => {
                const selected = document.querySelector(`input[name='question${index}']:checked`);
                if (selected) {
                    if (parseInt(selected.value) === q.answer) {
                        score++;
                    } else {
                        document.getElementById(`answer${index}`).style.display = 'block';
                    }
                }
            });
            const resultEl = document.getElementById('result');
            resultEl.textContent = `Bạn đạt ${score} / ${questions.length} điểm`;
            alert(`Bạn đạt ${score} / ${questions.length} điểm!`);
        }

        // Hàm reset lại bài thi
        function resetQuiz() {
            document.getElementById('result').textContent = '';
            questions.forEach((q, index) => {
                document.getElementById(`answer${index}`).style.display = 'none';
                const radios = document.getElementsByName(`question${index}`);
                radios.forEach(radio => radio.checked = false);
            });
        }
    </script>
</body>

</html>